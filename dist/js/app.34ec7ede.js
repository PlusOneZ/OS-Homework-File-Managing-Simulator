(function(e){function t(t){for(var n,r,l=t[0],a=t[1],s=t[2],u=0,f=[];u<l.length;u++)r=l[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);d&&d(t);while(f.length)f.shift()();return c.push.apply(c,s||[]),i()}function i(){for(var e,t=0;t<c.length;t++){for(var i=c[t],n=!0,l=1;l<i.length;l++){var a=i[l];0!==o[a]&&(n=!1)}n&&(c.splice(t--,1),e=r(r.s=i[0]))}return e}var n={},o={app:0},c=[];function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/OS-Homework-File-Managing-Simulator/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],a=l.push.bind(l);l.push=t,l=l.slice();for(var s=0;s<l.length;s++)t(l[s]);var d=a;c.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"0453":function(e,t,i){},"068a":function(e,t,i){"use strict";i("0453")},"553c":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("7a23"),o=(i("def6"),i("3fd4")),c=(i("7dd6"),{id:"app"});function r(e,t,i,o,r,l){var a=Object(n["M"])("Home");return Object(n["D"])(),Object(n["i"])("div",c,[Object(n["m"])(a)])}var l=Object(n["fb"])("data-v-0f3e98a2");Object(n["G"])("data-v-0f3e98a2");var a={class:"home"},s={class:"left-top-button"},d=Object(n["m"])("p",{class:"text-xl bold hd"}," 在线文件管理模拟器 ",-1),u={class:"button-right"},f={class:"button-left"},b={class:"dialog-footer"},h=Object(n["l"])("取 消"),m=Object(n["l"])("确定并重置");Object(n["E"])();var p=l((function(e,t,i,o,c,r){var p=Object(n["M"])("el-button"),O=Object(n["M"])("el-upload"),j=Object(n["M"])("el-header"),v=Object(n["M"])("EntireDirectory"),y=Object(n["M"])("el-aside"),g=Object(n["M"])("FolderView"),k=Object(n["M"])("el-input"),D=Object(n["M"])("el-form-item"),w=Object(n["M"])("el-form"),_=Object(n["M"])("el-dialog"),C=Object(n["M"])("el-main"),N=Object(n["M"])("el-container");return Object(n["D"])(),Object(n["i"])("div",a,[Object(n["m"])(N,{class:"frame"},{default:l((function(){return[Object(n["m"])(j,null,{default:l((function(){return[Object(n["m"])("div",s,[Object(n["m"])(p,{onClick:t[1]||(t[1]=function(e){return c.basicInfoVisible=!0}),circle:!0,icon:"el-icon-user",type:"success"})]),d,Object(n["m"])("div",u,[Object(n["m"])(p,{onClick:r.exportFile,circle:!0,icon:"el-icon-download",type:"primary"},null,8,["onClick"])]),Object(n["m"])(O,{ref:"upload",limit:1,"on-change":r.changeUploadFile,"file-list":void 0,"auto-upload":!1,multiple:!1,action:"#",accept:".json"},{default:l((function(){return[Object(n["m"])("div",f,[Object(n["m"])(p,{circle:!0,icon:"el-icon-upload2",type:"primary"})])]})),_:1},8,["on-change"])]})),_:1}),Object(n["m"])(N,{class:"frame"},{default:l((function(){return[Object(n["m"])(y,null,{default:l((function(){return[Object(n["m"])(v,{class:"pl-4",onDirChanged:r.treeDirChanged,onChangeSizeOfPath:r.updateSize,data:c.fileData,current:c.currentDir.key,disk:c.disk,ref:"directory",user:c.user_name},null,8,["onDirChanged","onChangeSizeOfPath","data","current","disk","user"])]})),_:1}),Object(n["m"])(C,null,{default:l((function(){return[Object(n["m"])(g,{directory:c.currentDir,disk:c.disk,view_mode:c.viewMode,onCreateDirectoryRequest:r.createDir,onCreateDocumentRequest:r.createDoc,onDirChangeRequest:r.changeDir,onViewChange:r.changeView,onChangeSizeOfPath:r.updateSize},null,8,["directory","disk","view_mode","onCreateDirectoryRequest","onCreateDocumentRequest","onDirChangeRequest","onViewChange","onChangeSizeOfPath"]),Object(n["m"])(_,{title:"基本信息",modelValue:c.basicInfoVisible,"onUpdate:modelValue":t[8]||(t[8]=function(e){return c.basicInfoVisible=e}),width:"40%"},{footer:l((function(){return[Object(n["m"])("span",b,[Object(n["m"])(p,{onClick:t[6]||(t[6]=function(e){return c.basicInfoVisible=!1}),style:{"margin-right":"10px"}},{default:l((function(){return[h]})),_:1}),Object(n["m"])(p,{type:"primary",onClick:t[7]||(t[7]=function(e){r.basicInfo(),c.basicInfoVisible=!1})},{default:l((function(){return[m]})),_:1})])]})),default:l((function(){return[Object(n["m"])(w,{"label-position":"left","label-width":"100px",onSubmit:t[5]||(t[5]=Object(n["eb"])((function(e){r.basicInfo(),c.basicInfoVisible=!1}),["prevent"]))},{default:l((function(){return[Object(n["m"])(D,{label:"用户名"},{default:l((function(){return[Object(n["m"])(k,{modelValue:c.user_name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.user_name=e}),ref:"userName"},null,8,["modelValue"])]})),_:1}),Object(n["m"])(D,{label:"磁盘块数量"},{default:l((function(){return[Object(n["m"])(k,{modelValue:c.block_amount,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.block_amount=e})},null,8,["modelValue"])]})),_:1}),Object(n["m"])(D,{label:"磁盘块大小(kb)"},{default:l((function(){return[Object(n["m"])(k,{modelValue:c.block_size,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.block_size=e})},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1},8,["modelValue"])]})),_:1})]})),_:1})]})),_:1})])})),O=(i("ac1f"),i("5319"),i("4d63"),i("25f0"),i("a9e3"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),Object(n["fb"])("data-v-a3cf0a66"));Object(n["G"])("data-v-a3cf0a66");var j={class:"text-lg pt-5 max-h-full"},v=Object(n["l"])(" Quick Add "),y={class:"custom-tree-node"},g={key:0,class:"el-icon-folder"},k={key:1,class:"el-icon-folder-opened"},D={key:2,class:"el-icon-document"};Object(n["E"])();var w=O((function(e,t,i,o,c,r){var l=Object(n["M"])("el-button"),a=Object(n["M"])("el-tree");return Object(n["D"])(),Object(n["i"])("div",j,[Object(n["m"])(l,{onClick:r.quickAdd},{default:O((function(){return[v]})),_:1},8,["onClick"]),Object(n["m"])(a,{data:i.data,"node-key":"key","default-expand-all":"",draggable:"",accordion:"","allow-drop":r.allowDrop,"allow-drag":r.allowDrag,onNodeDragEnd:r.dragEnd,ref:"tree",onDblclick:t[1]||(t[1]=function(t){return r.doubleClick(e.node)})},{default:O((function(e){var t=e.node,i=e.data;return[Object(n["m"])("span",y,[Object(n["m"])("span",null,[0!==i.type||t.expanded&&!t.isLeaf?Object(n["j"])("",!0):(Object(n["D"])(),Object(n["i"])("i",g)),0===i.type&&t.expanded&&!t.isLeaf?(Object(n["D"])(),Object(n["i"])("i",k)):Object(n["j"])("",!0),1===i.type?(Object(n["D"])(),Object(n["i"])("i",D)):Object(n["j"])("",!0),Object(n["l"])(" "+Object(n["Q"])(t.label),1)])])]})),_:1},8,["data","allow-drop","allow-drag","onNodeDragEnd"])])})),_=i("b85c"),C=1,N=0;function R(e){var t=e.lastIndexOf("/");return e.substring(0,t+1)}Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e};var x={name:"EntireDirectory",props:{data:Object,user:String,current:String,disk:Object},data:function(){return{defaultProps:{children:"children",label:"label"},openNode:"root/"}},methods:{allowDrop:function(e,t,i){return!!t&&("root/"===t.data.key?"prev"!==i&&"next"!==i&&"before"!==i:t.data.type!==C)},allowDrag:function(e){return"root"!==e.label&&-1===e.data.label.indexOf("三级 3-2-2")},dragEnd:function(){this.resetData(),console.log(this.data)},resetData:function(){console.log("reset"),console.log(this.data[0]),this.setKeyOf(this.data[0],"")},setKeyOf:function(e,t){if(console.log("node"+e.label),e["key"]=t+e.label+(e.type===N?"/":""),!e.isLeaf&&e.children){var i,n=Object(_["a"])(e.children);try{for(n.s();!(i=n.n()).done;){var o=i.value;console.log("child"+o),this.setKeyOf(o,e.key)}}catch(c){n.e(c)}finally{n.f()}}},calculateSize:function(e){for(var t=e.length,i=0;i<e.length;i++)e.charCodeAt(i)>255&&t++;return t/1024},addFile:function(e,t,i,n){var c=this;console.log(i),i||(i=this.$refs.tree.getCurrentKey(),i||(i="root/"));var r="";if("/"!==i.substr(-1,1)){var l=i.substring(0,i.lastIndexOf("/")+1);r=l+e}else r=i+e;if(t===N?r+="/":(e+=".txt",r+=".txt"),this.$refs.tree.getNode(r))return console.log("duplicate"),Object(o["a"])({showClose:!0,message:"创建失败，已经存在同名文件。",type:"error"}),!1;var a={label:e,key:r,type:t,creator:this.user,date:(new Date).format("yyyy/MM/dd hh:mm:ss")};t===N?(a["children"]=[],a["size"]=0):(a["content"]=n,a["size"]=this.calculateSize(n),a["blocks"]=[],0===a.size&&(a.size=this.calculateSize("1")));var s=Math.ceil(a.size/this.disk.block_size);"/"!==i.substr(-1,1)?(a.type===C&&this.allocateBlocks(s,a)||a.type===N)&&(this.insertSameLevel(a,i),Object(o["a"])({showClose:!0,message:"创建成功！",type:"success"})):(a.type===C&&this.allocateBlocks(s,a)||a.type===N)&&(this.append(a,i),Object(o["a"])({showClose:!0,message:"创建成功！",type:"success"})),setTimeout((function(){a.size>0&&c.$emit("changeSizeOfPath",a.key,a.size)}),500)},allocateBlocks:function(e,t){if(console.log(e),e>this.disk.available)return Object(o["a"])({showClose:!0,message:"空间不足",type:"error"}),!1;for(var i=0;i<e;i++)console.log("free_pointer ",this.disk.free_pointer),t.blocks.push(this.disk.free_pointer),this.disk.bit_table[this.disk.free_pointer]=!0,this.disk.storage[this.disk.free_pointer]=t.key,this.disk.available--,this.findNextDiskFreeSpace();return!0},findNextDiskFreeSpace:function(){for(var e=0;e<this.disk.block_amount;e++){if(!1===this.disk.bit_table[this.disk.free_pointer])return;this.disk.free_pointer=(this.disk.free_pointer+1)%this.disk.block_amount}},quickAdd:function(){var e=Math.floor(2*Math.random());e===N?this.addFile((new Date).format("h-m-s.S M-d".substr(0,21)),e,this.current):this.addFile((new Date).format("h-m-s.S M-d".substr(0,21)),e,this.current,"")},doubleClick:function(){if(this.openNode=this.$refs.tree.getCurrentNode(),console.log(this.openNode),this.openNode.type===N)this.$emit("dirChanged",this.openNode);else if(this.openNode.type===C){var e=R(this.openNode.key);this.$emit("fileOpened",this.openNode),this.openNode=this.$refs.tree.getNode(e),this.$emit("dirChanged",this.openNode)}},changeDir:function(e){var t=null;t=this.$refs.tree.getNode(e),console.log(t,"in changDir of ED"),t&&(this.openNode=t.data,this.$emit("dirChanged",this.openNode))},findChildrenOfData:function(e,t){if(t.key===e)return t;if(console.log(t,"in findChildrenOfData"),!t.children)return!1;for(var i=0;i<t.children.length;i++){var n=this.findChildrenOfData(e,t.children[i]);if(n)return n}},findParentOfData:function(e,t){if(e===t.key)return 1;if(console.log(t,"in findParentOfData"),!t.children)return!1;for(var i=0;i<t.children.length;i++){var n=this.findParentOfData(e,t.children[i]);if(n)return t}},append:function(e,t){var i=this.findChildrenOfData(t,this.data[0]);if(console.log(i,"in append"),i){var n=i.children;n.push(e)}else console.log("Error: cannot find"+t)},insertSameLevel:function(e,t){var i=this.findParentOfData(t,this.data[0]);if(console.log(i,"in insertSameLevel"),i){var n=i.children;n.push(e)}else console.log("Error: cannot find"+t)}},mounted:function(){this.resetData(),console.log("reset OK")},computed:{}};i("a9ac");x.render=w,x.__scopeId="data-v-a3cf0a66";var M=x,V=Object(n["fb"])("data-v-1ee13b52");Object(n["G"])("data-v-1ee13b52");var z={class:"flex line-45 pt-1"},S={key:0,class:" pt-4"},F=Object(n["l"])("取 消"),I=Object(n["l"])("确 定"),E={class:"dialog-footer"},q=Object(n["l"])("取 消"),$=Object(n["l"])("确 定"),B=Object(n["m"])("p",null," 文件内容： ",-1),W={class:"border-2 bg-blue-50 rounded-sm border-blue-500 p-2"},P={class:"font-medium font-sans overflow-clip"},K={key:0,class:"text-gray-300"},U={class:"dialog-footer"},A=Object(n["l"])("关 闭"),H=Object(n["m"])("p",null," 编辑内容： ",-1),L={class:"dialog-footer"},Q=Object(n["l"])("放弃修改"),T=Object(n["l"])("保 存"),G={class:"button-group"},J=Object(n["l"])(" 文件夹 "),Y=Object(n["l"])(" 文档 "),X=Object(n["m"])("div",{class:"h-5"},null,-1);Object(n["E"])();var Z=V((function(e,t,i,o,c,r){var l=Object(n["M"])("el-button"),a=Object(n["M"])("Path"),s=Object(n["M"])("el-header"),d=Object(n["M"])("File"),u=Object(n["M"])("FileRecord"),f=Object(n["M"])("DiskView"),b=Object(n["M"])("el-input"),h=Object(n["M"])("el-form-item"),m=Object(n["M"])("el-form"),p=Object(n["M"])("el-dialog"),O=Object(n["M"])("el-popover"),j=Object(n["M"])("el-main"),v=Object(n["M"])("el-container");return Object(n["D"])(),Object(n["i"])(v,{class:"frame"},{default:V((function(){return[Object(n["m"])(s,null,{default:V((function(){return[Object(n["m"])("div",z,[Object(n["m"])(l,{icon:"el-icon-arrow-left",circle:"",type:"primary",size:"small",onClick:r.goback,disabled:"root/"===i.directory.key},null,8,["onClick","disabled"]),Object(n["m"])(a,{"full-path":i.directory.key,onDirChangeRequest:r.dirChange},null,8,["full-path","onDirChangeRequest"])])]})),_:1}),Object(n["m"])(j,{class:"folder-view"},{default:V((function(){return[i.view_mode?(Object(n["D"])(),Object(n["i"])("div",S,[(Object(n["D"])(!0),Object(n["i"])(n["b"],null,Object(n["K"])(i.directory.children,(function(e){return Object(n["D"])(),Object(n["i"])(d,{key:e.key,data:e,onDirChangeRequest:r.dirChange,onDocReadRequest:r.openDoc,onDocEditRequest:r.editDoc,onRemoveDocRequest:r.removeDoc,onRemoveDirRequest:r.removeDir},null,8,["data","onDirChangeRequest","onDocReadRequest","onDocEditRequest","onRemoveDocRequest","onRemoveDirRequest"])})),128))])):Object(n["j"])("",!0),i.view_mode?Object(n["j"])("",!0):(Object(n["D"])(),Object(n["i"])(u,{key:1,directory:i.directory,onDirChangeRequest:r.dirChange,onDocReadRequest:r.openDoc,onDocEditRequest:r.editDoc,onRemoveDocRequest:r.removeDoc,onRemoveDirRequest:r.removeDir},null,8,["directory","onDirChangeRequest","onDocReadRequest","onDocEditRequest","onRemoveDocRequest","onRemoveDirRequest"])),i.view_mode?Object(n["j"])("",!0):(Object(n["D"])(),Object(n["i"])(f,{key:2,disk:i.disk},null,8,["disk"])),Object(n["m"])(p,{title:"新建文件夹",modelValue:c.showNewFolderWindow,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.showNewFolderWindow=e}),width:"30%"},{default:V((function(){return[Object(n["m"])(m,{"label-position":"left","label-width":"80px",onSubmit:t[4]||(t[4]=Object(n["eb"])((function(e){r.addNewDir(),c.showNewFolderWindow=!1,c.fileNameInput=""}),["prevent"]))},{default:V((function(){return[Object(n["m"])(h,{label:"文件名"},{default:V((function(){return[Object(n["m"])(b,{modelValue:c.fileNameInput,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.fileNameInput=e}),placeholder:c.hint,ref:"fileName"},null,8,["modelValue","placeholder"])]})),_:1}),Object(n["m"])(h,null,{default:V((function(){return[Object(n["m"])(l,{onClick:t[2]||(t[2]=function(e){c.showNewFolderWindow=!1,c.fileNameInput=""}),style:{"margin-right":"10px"}},{default:V((function(){return[F]})),_:1}),Object(n["m"])(l,{type:"primary",onClick:t[3]||(t[3]=function(e){r.addNewDir(),c.showNewFolderWindow=!1,c.fileNameInput=""})},{default:V((function(){return[I]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["modelValue"]),Object(n["m"])(p,{title:"新建文本文件",modelValue:c.showNewDocWindow,"onUpdate:modelValue":t[11]||(t[11]=function(e){return c.showNewDocWindow=e}),width:"65%"},{footer:V((function(){return[Object(n["m"])("span",E,[Object(n["m"])(l,{onClick:t[9]||(t[9]=function(e){c.showNewDocWindow=!1,c.fileNameInput=""}),style:{"margin-right":"10px"}},{default:V((function(){return[q]})),_:1}),Object(n["m"])(l,{type:"primary",onClick:t[10]||(t[10]=function(e){r.addNewDoc(),c.showNewDocWindow=!1,c.fileNameInput=""})},{default:V((function(){return[$]})),_:1})])]})),default:V((function(){return[Object(n["m"])(m,{"label-position":"left","label-width":"100px",onSubmit:t[8]||(t[8]=Object(n["eb"])((function(e){r.addNewDoc(),c.showNewDocWindow=!1,c.fileNameInput="",c.docContent=""}),["prevent"]))},{default:V((function(){return[Object(n["m"])(h,{label:"文件名"},{default:V((function(){return[Object(n["m"])(b,{modelValue:c.fileNameInput,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.fileNameInput=e}),placeholder:c.hint,ref:"fileName2"},null,8,["modelValue","placeholder"])]})),_:1}),Object(n["m"])(h,{label:"文件内容："},{default:V((function(){return[Object(n["m"])(b,{type:"textarea",autosize:{minRows:20,maxRows:30},placeholder:"请输入内容",modelValue:c.docContent,"onUpdate:modelValue":t[7]||(t[7]=function(e){return c.docContent=e})},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1},8,["modelValue"]),Object(n["m"])(p,{title:c.viewDocName,modelValue:c.showDocViewerWindow,"onUpdate:modelValue":t[13]||(t[13]=function(e){return c.showDocViewerWindow=e}),width:"50%"},{footer:V((function(){return[Object(n["m"])("span",U,[Object(n["m"])(l,{type:"primary",onClick:t[12]||(t[12]=function(e){c.showDocViewerWindow=!1})},{default:V((function(){return[A]})),_:1})])]})),default:V((function(){return[Object(n["m"])("div",null,[B,Object(n["m"])("div",W,[Object(n["m"])("p",P,Object(n["Q"])(c.viewDocContent),1),c.viewDocContent?Object(n["j"])("",!0):(Object(n["D"])(),Object(n["i"])("p",K," 该文档没有内容 "))])])]})),_:1},8,["title","modelValue"]),Object(n["m"])(p,{title:c.editDocName,modelValue:c.showEditWindow,"onUpdate:modelValue":t[17]||(t[17]=function(e){return c.showEditWindow=e}),width:"50%"},{footer:V((function(){return[Object(n["m"])("span",L,[Object(n["m"])(l,{onClick:t[15]||(t[15]=function(e){c.showEditWindow=!1})},{default:V((function(){return[Q]})),_:1}),Object(n["m"])(l,{type:"primary",onClick:t[16]||(t[16]=function(e){r.saveEditDoc(),c.showEditWindow=!1})},{default:V((function(){return[T]})),_:1})])]})),default:V((function(){return[Object(n["m"])("div",null,[H,Object(n["m"])(b,{type:"textarea",autosize:{minRows:20,maxRows:30},placeholder:"请输入内容",modelValue:c.editDocContent,"onUpdate:modelValue":t[14]||(t[14]=function(e){return c.editDocContent=e})},null,8,["modelValue"])])]})),_:1},8,["title","modelValue"]),Object(n["m"])("div",G,[Object(n["m"])("div",null,[Object(n["m"])(O,{placement:"left",title:"选择类型",width:"150px"},{reference:V((function(){return[Object(n["m"])(l,{icon:"el-icon-plus",circle:"",type:"success",class:" shadow-lg",onClick:t[18]||(t[18]=function(t){return e.addWindowVisible=!0})})]})),default:V((function(){return[Object(n["m"])("div",null,[Object(n["m"])(l,{icon:"el-icon-folder-add",class:"in-pop",onClick:r.newFolderWindow},{default:V((function(){return[J]})),_:1},8,["onClick"]),Object(n["m"])(l,{icon:"el-icon-document-add",class:"in-pop",onClick:r.newDocWindow},{default:V((function(){return[Y]})),_:1},8,["onClick"])])]})),_:1})]),X,Object(n["m"])("div",null,[Object(n["m"])(l,{icon:"el-icon-info",circle:"",type:"primary",class:" shadow-lg",onClick:r.viewChange},null,8,["onClick"])])])]})),_:1})]})),_:1})})),ee=(i("a434"),Object(n["fb"])("data-v-753885e5"));Object(n["G"])("data-v-753885e5");var te={class:"inline-flex"},ie=Object(n["l"])(" 打开 "),ne=Object(n["l"])(" 编辑 "),oe=Object(n["l"])(" 删除 "),ce={class:"inline-flex h-20 w-20 focus:overflow-ellipsis"},re={key:0,class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"100",height:"80"},le=Object(n["m"])("path",{d:"M853.333333 256H469.333333l-85.333333-85.333333H170.666667c-46.933333 0-85.333333 38.4-85.333334 85.333333v170.666667h853.333334v-85.333334c0-46.933333-38.4-85.333333-85.333334-85.333333z",fill:"#FFA000"},null,-1),ae=Object(n["m"])("path",{d:"M853.333333 256H170.666667c-46.933333 0-85.333333 38.4-85.333334 85.333333v426.666667c0 46.933333 38.4 85.333333 85.333334 85.333333h682.666666c46.933333 0 85.333333-38.4 85.333334-85.333333V341.333333c0-46.933333-38.4-85.333333-85.333334-85.333333z",fill:"#FFCA28"},null,-1),se={key:1,class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"100",height:"80"},de=Object(n["m"])("path",{d:"M853.333333 960H170.666667V64h469.333333l213.333333 213.333333z",fill:"#90CAF9"},null,-1),ue=Object(n["m"])("path",{d:"M821.333333 298.666667H618.666667V96z",fill:"#E1F5FE"},null,-1),fe=Object(n["m"])("path",{d:"M341.333333 448h362.666667v42.666667H341.333333zM341.333333 533.333333h277.333334v42.666667H341.333333zM341.333333 618.666667h362.666667v42.666666H341.333333zM341.333333 704h277.333334v42.666667H341.333333z",fill:"#1976D2"},null,-1),be={class:"break-all truncate w-24 overflow-hidden"};Object(n["E"])();var he=ee((function(e,t,i,o,c,r){var l=Object(n["M"])("el-button"),a=Object(n["M"])("el-popover");return Object(n["D"])(),Object(n["i"])("div",te,[Object(n["m"])(a,{placement:"right",width:160,visible:c.contextmenuVisible},{reference:ee((function(){return[Object(n["m"])(l,{class:"hover:shadow-lg",onDblclick:r.doubleClick,onBlur:t[2]||(t[2]=function(e){return c.contextmenuVisible=!1}),onContextmenu:t[3]||(t[3]=Object(n["eb"])((function(e){return c.contextmenuVisible=!0}),["prevent"]))},{default:ee((function(){return[Object(n["m"])("div",ce,[0===i.data.type?(Object(n["D"])(),Object(n["i"])("svg",re,[le,ae])):Object(n["j"])("",!0),1===i.data.type?(Object(n["D"])(),Object(n["i"])("svg",se,[de,ue,fe])):Object(n["j"])("",!0)]),Object(n["m"])("div",be,Object(n["Q"])(i.data.label),1)]})),_:1},8,["onDblclick"])]})),default:ee((function(){return[Object(n["m"])("div",null,[Object(n["m"])(l,{onClick:r.doubleClick,class:"contextmenu"},{default:ee((function(){return[ie]})),_:1},8,["onClick"]),0!==i.data.type?(Object(n["D"])(),Object(n["i"])(l,{key:0,onClick:t[1]||(t[1]=function(e){return r.doubleClick(1)}),class:"contextmenu"},{default:ee((function(){return[ne]})),_:1})):Object(n["j"])("",!0),Object(n["m"])(l,{onClick:r.deleteFileOrDirectory,class:"contextmenu"},{default:ee((function(){return[oe]})),_:1},8,["onClick"])])]})),_:1},8,["visible"])])})),me=1,pe=0,Oe={name:"File",props:{data:Object},data:function(){return{contextmenuVisible:!1}},methods:{doubleClick:function(e){this.data.type===me?1===e?this.$emit("docEditRequest",this.data):this.$emit("docReadRequest",this.data):this.data.type===pe&&this.$emit("dirChangeRequest",this.data.key)},deleteFileOrDirectory:function(){this.data.type===me?this.$emit("removeDocRequest",this.data.key):this.$emit("removeDirRequest",this.data.key)}}};i("d734");Oe.render=he,Oe.__scopeId="data-v-753885e5";var je=Oe,ve=Object(n["fb"])("data-v-7913b50c");Object(n["G"])("data-v-7913b50c");var ye={href:"#"};Object(n["E"])();var ge=ve((function(e,t,i,o,c,r){var l=Object(n["M"])("el-breadcrumb-item"),a=Object(n["M"])("el-breadcrumb");return Object(n["D"])(),Object(n["i"])(a,{separator:"/"},{default:ve((function(){return[(Object(n["D"])(!0),Object(n["i"])(n["b"],null,Object(n["K"])(r.pathList,(function(e,t){return Object(n["D"])(),Object(n["i"])(l,{key:t,onClick:function(e){return r.goto(t)}},{default:ve((function(){return[Object(n["m"])("a",ye,Object(n["Q"])(e),1)]})),_:2},1032,["onClick"])})),128))]})),_:1})})),ke=(i("1276"),{name:"Path",props:{fullPath:String},computed:{pathList:function(){var e=this.fullPath.substring(0,this.fullPath.length-1).split("/");return e}},methods:{goto:function(e){for(var t="",i=0;i<=e;i++)t+=this.pathList[i]+"/";this.$emit("dirChangeRequest",t)}}});i("ff10");ke.render=ge,ke.__scopeId="data-v-7913b50c";var De=ke,we=Object(n["fb"])("data-v-733fdce2");Object(n["G"])("data-v-733fdce2");var _e={class:"justify-center content-center half bg-gray-700"},Ce={class:"font-mono text-white",style:{width:"100%"}},Ne={class:"table-fixed pl-5",style:{width:"100%"}},Re=Object(n["m"])("thead",null,[Object(n["m"])("tr",{class:"text-left"},[Object(n["m"])("th",{style:{width:"16.67%"}},"Creator"),Object(n["m"])("th",{style:{width:"16.67%"}},"Size"),Object(n["m"])("th",{style:{width:"16.67%"}},"Date"),Object(n["m"])("th",{style:{width:"10%"}},"Type"),Object(n["m"])("th",{style:{width:"40%"}},"File Name")])],-1);Object(n["E"])();var xe=we((function(e,t,i,o,c,r){return Object(n["D"])(),Object(n["i"])("div",_e,[Object(n["m"])("div",Ce,[Object(n["m"])("table",Ne,[Re,Object(n["m"])("tbody",null,[(Object(n["D"])(!0),Object(n["i"])(n["b"],null,Object(n["K"])(i.directory.children,(function(e){return Object(n["D"])(),Object(n["i"])("tr",{key:e.key,onDblclick:function(t){return r.doubleClick(e,0)},onContextmenu:t[1]||(t[1]=Object(n["eb"])((function(e){return c.contextmenuVisible=!0}),["prevent"]))},[Object(n["m"])("td",null,Object(n["Q"])(e.creator),1),Object(n["m"])("td",null,Object(n["Q"])(e.size),1),Object(n["m"])("td",null,Object(n["Q"])(e.date),1),Object(n["m"])("td",null,Object(n["Q"])(0===e.type?"DIR":"DOC"),1),Object(n["m"])("td",null,Object(n["Q"])(e.label),1)],40,["onDblclick"])})),128))])])])])})),Me=1,Ve=0,ze={name:"FileRecord",props:{directory:Object},data:function(){return{contextmenuVisible:!1}},methods:{doubleClick:function(e,t){e.type===Me?1===t?this.$emit("docEditRequest",e):this.$emit("docReadRequest",e):e.type===Ve&&this.$emit("dirChangeRequest",e.key)},deleteFileOrDirectory:function(e){e.type===Me?this.$emit("removeDocRequest",e.key):this.$emit("removeDirRequest",e.key)}}};i("068a");ze.render=xe,ze.__scopeId="data-v-733fdce2";var Se=ze,Fe=Object(n["fb"])("data-v-55fb2a18");Object(n["G"])("data-v-55fb2a18");var Ie={class:"py-8 px-8 bg-gray-700 disk"};Object(n["E"])();var Ee=Fe((function(e,t,i,o,c,r){return Object(n["D"])(),Object(n["i"])("div",Ie,[Object(n["m"])("p",null," 剩余空间： "+Object(n["Q"])(i.disk.available),1),(Object(n["D"])(!0),Object(n["i"])(n["b"],null,Object(n["K"])(i.disk.bit_table,(function(e,t){return Object(n["D"])(),Object(n["i"])("div",{key:t,class:"rounded-sm w-4 h-4 mx-1 my-1 inline-flex",style:{background:e?"#39d353":"white"}},null,4)})),128))])})),qe={name:"DiskView",props:{disk:Object}};i("b5e0");qe.render=Ee,qe.__scopeId="data-v-55fb2a18";var $e=qe;Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)};var Be={name:"FolderView",props:{directory:Object,disk:Object,view_mode:Boolean},data:function(){return{showNewFolderWindow:!1,showNewDocWindow:!1,showDocViewerWindow:!1,showEditWindow:!1,hint:"不包含 . / ' \" $ { } 符号",fileNameInput:Object(n["I"])(""),docContent:Object(n["I"])(""),editDocContent:Object(n["I"])(""),viewDocContent:Object(n["I"])(""),viewDocName:Object(n["I"])(""),editDocName:Object(n["I"])(""),docBeingEdited:null}},components:{DiskView:$e,FileRecord:Se,File:je,Path:De},methods:{newFolderWindow:function(){var e=this;this.showNewFolderWindow=!0,setTimeout((function(){e.$refs.fileName.focus()}),300)},newDocWindow:function(){var e=this;this.showNewDocWindow=!0,setTimeout((function(){e.$refs.fileName2.focus()}),300)},viewChange:function(){this.$emit("viewChange")},dirChange:function(e){console.log(e,"in dirChange"),this.$emit("dirChangeRequest",e)},addDoc:function(e,t){console.log(e,t)},addDir:function(e){console.log(e)},goback:function(){var e=this.directory.key.substring(0,this.directory.key.length-1);e=e.substring(0,e.lastIndexOf("/")+1),this.$emit("dirChangeRequest",e)},addNewDir:function(){console.log("Adding file ",this.fileNameInput," in dir ",this.directory.key),this.checkInputFile(this.fileNameInput)?this.$emit("createDirectoryRequest",this.fileNameInput,this.directory.key):Object(o["a"])({showClose:!0,message:"含有非法字符，建立失败",type:"error"})},addNewDoc:function(){console.log("Adding file ",this.fileNameInput," in dir ",this.directory.key),this.checkInputFile(this.fileNameInput)?this.$emit("createDocumentRequest",this.fileNameInput,this.directory.key,this.docContent):Object(o["a"])({showClose:!0,message:"含有非法字符，建立失败",type:"error"}),this.editDocContent="",this.docContent=""},checkInputFile:function(e){if(""===e)return!1;for(var t=["/",".","'",'"',"$","{","}"],i=0,n=t;i<n.length;i++){var o=n[i];if(e.indexOf(o)>0)return!1}return!0},openDoc:function(e){this.viewDocName=e.label,this.viewDocContent=e.content,this.showDocViewerWindow=!0},editDoc:function(e){this.docBeingEdited=e.key,this.editDocName=e.label,this.editDocContent=e.content,this.showEditWindow=!0},findByKey:function(e,t){if(t.key===e)return t;if(console.log(t,"in findByKey of FolderView"),!t.children)return!1;for(var i=0;i<t.children.length;i++){var n=this.findByKey(e,t.children[i]);if(n)return n}},findParentByKey:function(e,t){if(e===t.key)return 1;if(console.log(t,"in findParentByKey of FolderView"),!t.children)return!1;for(var i=0;i<t.children.length;i++){var n=this.findParentByKey(e,t.children[i]);if(n)return t}},saveEditDoc:function(){var e=this.findByKey(this.docBeingEdited,this.directory),t=this.calculateSize(this.editDocContent);this.setBlockOf(e,t),this.updateDirectorySize(e.key,e.size-t),e.size=t,e.content=this.editDocContent,this.editDocContent="",this.docBeingEdited=null,this.editDocName="",Object(o["a"])({showClose:!0,message:"保存成功！",type:"success"})},setBlockOf:function(e,t){var i=e.blocks.length,n=Math.ceil(t/this.disk.block_size);0===n&&(n=1),i!==n&&(i>n?this.retrieveSpaceOf(e,i-n):this.allocateBlocks(n-i,e))},removeByKey:function(e,t){var i,n=Object(_["a"])(e);try{for(n.s();!(i=n.n()).done;){var o=i.value;if(o.key===t)return e.remove(o),!0}}catch(c){n.e(c)}finally{n.f()}return!1},removeDoc:function(e){var t=this.findParentByKey(e,this.directory),i=this.findByKey(e,this.directory);this.updateDirectorySize(i.key,-i.size),this.retrieveSpaceOf(i),this.removeByKey(t.children,e)?Object(o["a"])({showClose:!0,message:"已删除"+e,type:"success"}):Object(o["a"])({showClose:!0,message:"删除错误",type:"error"})},removeDir:function(e){var t=this.findParentByKey(e,this.directory),i=this.findByKey(e,this.directory);this.removeAllDocUnderDir(i),this.removeByKey(t.children,e)?Object(o["a"])({showClose:!0,message:"已删除"+e,type:"success"}):Object(o["a"])({showClose:!0,message:"删除错误",type:"error"})},removeAllDocUnderDir:function(e){var t,i=Object(_["a"])(e.children);try{for(i.s();!(t=i.n()).done;){var n=t.value;0!==n.type?(this.retrieveSpaceOf(n),this.updateDirectorySize(n.key,-n.size)):this.removeAllDocUnderDir(n)}}catch(o){i.e(o)}finally{i.f()}},allocateBlocks:function(e,t){if(console.log(e),e>this.disk.available)return Object(o["a"])({showClose:!0,message:"空间不足",type:"error"}),!1;for(var i=0;i<e;i++)console.log("free_pointer ",this.disk.free_pointer),t.blocks.push(this.disk.free_pointer),this.disk.bit_table[this.disk.free_pointer]=!0,this.disk.storage[this.disk.free_pointer]=t.key,this.findNextDiskFreeSpace();return!0},findNextDiskFreeSpace:function(){for(var e=0;e<this.disk.block_amount;e++){if(!1===this.disk.bit_table[this.disk.free_pointer])return;this.disk.free_pointer=(this.disk.free_pointer+1)%this.disk.block_amount}},retrieveSpaceOf:function(e,t){if(e.blocks){t||(t=e.blocks.length);for(var i=0;i<t;i++)this.disk.bit_table[e.blocks.pop()]=!1,this.disk.available++}},calculateSize:function(e){for(var t=e.length,i=0;i<e.length;i++)e.charCodeAt(i)>255&&t++;return t/1024},updateDirectorySize:function(e,t){this.$emit("changeSizeOfPath",e,t)}},mounted:function(){}};i("d923");Be.render=Z,Be.__scopeId="data-v-1ee13b52";var We=Be,Pe=1,Ke=0;Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[i]:("00"+t[i]).substr((""+t[i]).length)));return e};var Ue=(new Date).format("yyyy/MM/dd hh:mm:ss"),Ae={key:"root/",label:"root",type:Ke,isLeaf:!1,children:[],creator:"system",size:0,date:Ue},He={name:"Home",components:{EntireDirectory:M,FolderView:We},data:function(){return{fileData:[Ae],currentDir:void 0,disk:{block_size:4,block_amount:512,bit_table:[],storage:[],available:null,free_pointer:0},user_name:Object(n["I"])("root"),viewMode:!0,basicInfoVisible:!0,block_amount:Object(n["I"])("512"),block_size:Object(n["I"])("4")}},methods:{basicInfo:function(){console.log(Number(this.block_amount)),Number(this.block_amount)&&(this.disk.block_amount=Number(this.block_amount),console.log("haha",this.disk.block_amount)),this.block_amount=String(this.disk.block_amount),Number(this.block_size)&&(this.disk.block_size=Number(this.block_size)),this.block_size=String(this.disk.block_size),this.resetDisk()},updateSize:function(e,t){console.log("updateSize: path: ",e),this.startUpdate(this.fileData[0],e,t)},startUpdate:function(e,t,i){if(e.key===t)return e;if(console.log(e,"in changeSize"),!e.children)return!1;for(var n=0;n<e.children.length;n++){var o=this.startUpdate(e.children[n],t,i);if(o)return e.size+=i,o}},changeUploadFile:function(e){"ready"===e.status?this.handleUpload(e):"fail"===e.status&&Object(o["a"])({showClose:!0,message:"上传出错",type:"error"})},handleUpload:function(e){var t=new FileReader;t.readAsText(e.raw);var i=this;t.onload=function(e){var t=JSON.parse(e.target.result);t&&(console.log("parse OK"),i.fileData=t.fileData,i.disk=t.disk,setTimeout((function(){i.$refs.directory.changeDir("root/")}),500))}},exportFile:function(){var e=new Blob([JSON.stringify({fileData:this.fileData,disk:this.disk})],{type:"application/json"}),t=document.createElement("a");t.download="ArchivedFiles",t.href=URL.createObjectURL(e),t.style.visibility="none",t.click(),Object(o["a"])({showClose:!0,message:"成功导出，请查看下载文件夹",type:"success"})},treeDirChanged:function(e){e&&(console.log("in treeDirChanged"),console.log(e),this.currentDir=e)},changeDir:function(e){console.log(e,"in changeDir of home"),this.$refs.directory.changeDir(e)},createDir:function(e,t){console.log(e,t,"in createDir of home"),this.$refs.directory.addFile(e,Ke,t)},createDoc:function(e,t,i){console.log(e,t,"in createDoc of home"),this.$refs.directory.addFile(e,Pe,t,i)},changeView:function(){this.viewMode=!this.viewMode},resetDisk:function(){var e=this;this.disk.bit_table=[],this.disk.storage=[],this.fileData=[Ae];for(var t=0;t<this.disk.block_amount;t++)this.disk.bit_table[t]=!1,this.disk.storage[t]=null;this.disk.available=this.disk.block_amount,setTimeout((function(){e.changeDir("root/")}),500)}},created:function(){this.currentDir=this.fileData[0],this.resetDisk()}};i("fd89");He.render=p,He.__scopeId="data-v-0f3e98a2";var Le=He,Qe={name:"App",components:{Home:Le}};i("d119");Qe.render=r;var Te=Qe,Ge=Object(n["h"])(Te);Ge.use(o["b"]),Ge.mount("#app")},"9b47":function(e,t,i){},"9d92":function(e,t,i){},a9ac:function(e,t,i){"use strict";i("553c")},b5e0:function(e,t,i){"use strict";i("fd19")},be8a:function(e,t,i){},d119:function(e,t,i){"use strict";i("f96f")},d734:function(e,t,i){"use strict";i("be8a")},d815:function(e,t,i){},d923:function(e,t,i){"use strict";i("d815")},def6:function(e,t,i){},f96f:function(e,t,i){},fd19:function(e,t,i){},fd89:function(e,t,i){"use strict";i("9d92")},ff10:function(e,t,i){"use strict";i("9b47")}});
//# sourceMappingURL=app.34ec7ede.js.map